# ==============================================
# SERVER CONFIGURATION
# ==============================================
PORT=5000
NODE_ENV=development

# Domain Configuration (for production)
DOMAIN=your-domain.com
BASE_URL=https://your-domain.com

# ==============================================
# DATABASE CONFIGURATION
# ==============================================
# Primary MongoDB Connection String (Required)
MONGO_URI=mongodb+srv://user:password@cluster.mongodb.net/link-snap

# Local MongoDB Fallback (Optional - for development)
MONGO_URI_LOCAL=mongodb://127.0.0.1:27017/link-snap

# Toggle to force local DB usage even if MONGO_URI is present
# Set 'true' for offline dev, 'false' for cloud
USE_LOCAL_DB=false

# ==============================================
# SECURITY & AUTHENTICATION
# ==============================================
# JSON Web Token Secrets (MUST be strong random strings)
# Generate with: openssl rand -base64 32
JWT_ACCESS_SECRET=your_super_secret_access_key
JWT_REFRESH_SECRET=your_super_secret_refresh_key

# Session Secret (Required for CSRF Protection)
SESSION_SECRET=your_cookie_session_secret_key

# Encryption Key for sensitive data at rest (Must be exactly 32 chars)
ENCRYPTION_KEY=12345678901234567890123456789012

# Ghost Mode / Stealth Admin
# Enable detailed admin routes? (true/false)
ADMIN_ENABLED=true

# IP Whitelisting for Admin Panel
# Comma-separated list of allowed IPs. Localhost (127.0.0.1, ::1) is auto-included.
ADMIN_WHITELIST_IPS=

# Rate Limit Whitelist (Bypass API limits)
RATE_LIMIT_WHITELIST_IPS=

# Cookie Security (strict, lax, none)
# Use 'strict' for production domains, 'lax' for dev/tunnels
COOKIE_SAMESITE=lax

# Content Security Policy (CSP)
# Set to 'false' if experiencing issues with inline scripts during dev
CSP_ENABLED=true

# ==============================================
# PROXY GATE SECURITY (Azure → AWS Architecture)
# ==============================================
# These settings secure the AWS backend when accessed only through Azure proxy.
# This implements 4-layer security: Firewall → VPN → Secret Token → IP Whitelist
#
# TOGGLE: Enable/disable proxy gate security
# Set to 'true' in production (AWS), 'false' for local development
PROXY_GATE_ENABLED=false

# SECRET TOKEN: Must match Nginx proxy_set_header X-LinkSnap-Proxy-Secret
# Generate with: openssl rand -hex 32
# This secret is verified on every request (except /health)
PROXY_SECRET=

# TRUSTED PROXY IPs: Comma-separated list of Tailscale IPs allowed to access AWS
# Example single: 100.90.234.100
# Example multiple: 100.90.234.100,100.90.234.101,100.90.234.102
# These are your Azure proxy server Tailscale IPs
TRUSTED_PROXY_IPS=

# REAL IP HEADER: The header name Azure Nginx uses to pass real user IP
# Must match: proxy_set_header X-Real-IP $remote_addr; in Nginx config
# Default is 'x-real-ip' (lowercase - HTTP headers are case-insensitive)
REAL_IP_HEADER=x-real-ip

# Google Safe Browsing API (Usage must be non-commercial for free tier)
# Get key: https://console.cloud.google.com/apis/library/safebrowsing.googleapis.com
GOOGLE_SAFE_BROWSING_KEY=demo_key_production


# ==============================================
# CLIENT & CORS
# ==============================================
# URL of the frontend application (for CORS)
# Development: http://localhost:5173
# Production: Use DOMAIN or BASE_URL from above
CLIENT_URL=http://localhost:5173

# ==============================================
# BIOMETRIC / DEVICE AUTH (WebAuthn)
# ==============================================
# The domain/ID of your application
# Development: localhost
# Production: Use DOMAIN from above (without protocol)
WEBAUTHN_RP_ID=localhost
# Human-readable name for authenticator apps
WEBAUTHN_RP_NAME=Link-Snap
# Full origin with protocol
# Development: http://localhost:5173
# Production: Use BASE_URL from above
WEBAUTHN_ORIGIN=http://localhost:5173
# Maximum trusted devices per admin user
MAX_TRUSTED_DEVICES=10

# ==============================================
# EMAIL SETTINGS (SMTP)
# ==============================================
# SMTP Server Details (e.g., Gmail, SendGrid)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
# Support email address displayed in templates
SUPPORT_EMAIL=support@linksnap.app

# ==============================================
# SUBSCRIPTIONS & PAYMENTS
# ==============================================
# Lemon Squeezy API Keys
LEMONSQUEEZY_API_KEY=your_api_key
LEMONSQUEEZY_STORE_ID=12345
LEMONSQUEEZY_WEBHOOK_SECRET=your_webhook_secret

# Product/Variant IDs
LEMONSQUEEZY_PRO_MONTHLY_VARIANT_ID=00000
LEMONSQUEEZY_PRO_YEARLY_VARIANT_ID=00000

# Grace period for failed payments
SUBSCRIPTION_GRACE_PERIOD_DAYS=7

# ==============================================
# SESSION MANAGEMENT
# ==============================================
MAX_SESSIONS_PER_USER=10
SESSION_DURATION_DAYS=30



# Optional: List of internal proxy IPs to trust (comma-separated)
TRUSTED_PROXIES=10.0.0.1, 192.168.1.1, 172.16.0.0/12

# ==============================================
# INTERNAL API SECURITY
# ==============================================
# Secret for protecting internal-only endpoints like edge analytics
# These endpoints are called by Nginx proxy, not by external users
# Generate with: openssl rand -hex 32
# Configure Nginx: proxy_set_header X-Internal-Analytics-Secret $secret;
INTERNAL_ANALYTICS_SECRET=your_64_character_hex_secret_here_generate_with_openssl_rand